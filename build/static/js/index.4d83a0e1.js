import{h as l,K as v,M as $,w as c,A as y,q as w,u as b,O as z,e as h,Q as T,j as e,U as S,V as E,X as x,t as N,s as F,m as A}from"./entryPointFactory.769a35d1.js";import{L as O}from"./index.e6917ec6.js";import{F as C}from"./AuthLayout.7c6c8571.js";import{g as P}from"./validators.78252eaf.js";import{F as u,I as f,B as g}from"./index.1ca238f3.js";import{u as R}from"./index.3e5f4c4f.js";import{C as _}from"./CheckCircleOutlined.6326d88b.js";var q={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M603.3 327.5l-246 178a7.95 7.95 0 000 12.9l246 178c5.3 3.8 12.7 0 12.7-6.5V643c0-10.2-4.9-19.9-13.2-25.9L457.4 512l145.4-105.2c8.3-6 13.2-15.6 13.2-25.9V334c0-6.5-7.4-10.3-12.7-6.5z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"left-circle",theme:"outlined"};const B=q;var D=function(a,s){return l.createElement(v,$({},a,{ref:s,icon:B}))};const M=l.forwardRef(D),W=({onRegisterSuccess:t})=>{const a=R(),s=w(),r=b(z),[i]=u.useForm(),n=h("register"),o=h("global"),d=l.useCallback(m=>{a(T({data:m,resolve:()=>{i.resetFields(),t(m.email)}}))},[a,i,t]),p=l.useCallback(()=>{s("/login")},[s]);return e.jsx(C,{children:e.jsxs(u,{form:i,onFinish:d,children:[e.jsx(u.Item,{name:"username",rules:[{required:!0,message:`${n("username")}${o("validation.required")}`}],children:e.jsx(f,{placeholder:n("username"),size:"large"})}),e.jsx(u.Item,{name:"email",rules:[{required:!0,message:`${n("email")}${o("validation.required")}`},{type:"email"}],children:e.jsx(f,{placeholder:n("email"),type:"email",size:"large"})}),e.jsx(u.Item,{name:"password",rules:[{required:!0,message:`${n("password")}${o("validation.required")}`},{validator:P(o("validation.invalidPassword"))}],children:e.jsx(f.Password,{placeholder:n("password"),size:"large"})}),e.jsx(u.Item,{className:"last",shouldUpdate:!0,children:()=>e.jsx(g,{type:"primary",htmlType:"submit",size:"large",loading:r,disabled:r||!i.isFieldsTouched(!0)||!!i.getFieldsError().filter(({errors:m})=>m.length).length,block:!0,children:n("register")})}),e.jsxs(V,{children:[n("desc1"),e.jsx(G,{onClick:p,children:n("login")})]})]})})},V=c.div.withConfig({displayName:"RegisterForm__Links",componentId:"sc-f8xiwy-0"})(["line-height:",";color:",";text-align:right;"],y,t=>t.theme.textColorLight),G=c.a.withConfig({displayName:"RegisterForm__LinkButton",componentId:"sc-f8xiwy-1"})(["line-height:",";"],y),H=({email:t,loading:a,onBack:s,onSendEmailAgain:r})=>{const i=h("register"),n=l.useCallback(()=>{if(t){const o=t.split("@")[1];let d=`https://mail.${o}`;switch(o){case"live.cn":d=`https://${o}`;break;case"live.com":d=`https://${o}`;break}window.open(d)}},[t]);return e.jsxs(C,{children:[e.jsx(U,{}),e.jsx(X,{children:i("tipTitle")}),e.jsxs(k,{children:[i("tipDesc1"),e.jsx("b",{children:t}),i("tipDesc2"),e.jsx(g,{type:"link",size:"small",onClick:n,children:i("toMailbox")}),i("tipDesc3")]}),e.jsxs(k,{children:[i("tipDesc4"),e.jsx(g,{type:"link",size:"small",loading:a,onClick:r,children:i("resend")})]}),e.jsxs(g,{size:"large",style:{width:"100%"},type:"primary",onClick:s,children:[e.jsx(M,{})," ",i("back")]})]})},U=c(_).withConfig({displayName:"SendEmailTips__Success",componentId:"sc-1wk8t0l-0"})(["display:block;padding-bottom:",";font-size:",";color:",";text-align:center;"],S,E(12),t=>t.theme.success),X=c.h1.withConfig({displayName:"SendEmailTips__Title",componentId:"sc-1wk8t0l-1"})(["padding-bottom:",";text-align:center;"],x),k=c.p.withConfig({displayName:"SendEmailTips__Content",componentId:"sc-1wk8t0l-2"})(["margin:"," 0;"],x),K=({onContinue:t})=>{const a=w(),s=h("register"),r=l.useCallback(()=>{a("/login")},[a]);return e.jsxs(C,{children:[e.jsx(Q,{}),e.jsx(J,{children:s("registerSuccess")}),e.jsxs(Y,{children:[s("tipDesc5"),e.jsx(g,{type:"link",size:"small",onClick:r,children:s("goLogin")}),s("tipDesc6"),e.jsx(g,{type:"link",size:"small",onClick:t,children:s("continue")})]})]})},Q=c(_).withConfig({displayName:"WithoutActivation__Success",componentId:"sc-1jn256a-0"})(["display:block;padding-bottom:",";font-size:",";color:",";text-align:center;"],S,E(12),t=>t.theme.success),J=c.h1.withConfig({displayName:"WithoutActivation__Title",componentId:"sc-1jn256a-1"})(["padding-bottom:",";text-align:center;"],x),Y=c.p.withConfig({displayName:"WithoutActivation__Content",componentId:"sc-1jn256a-2"})(["margin:"," 0;text-align:center;"],x),Z=async t=>{const{data:a}=await N({url:"/users/sendmail",method:"POST",params:{usernameOrEmail:t}});return a};function le(){const[t,a]=l.useState(!1),[s,r]=l.useState(""),[i,n]=l.useState(!1),o=b(F),d=(o==null?void 0:o.mailEnable)??!0,p=h("register"),m=l.useCallback(I=>{r(I),a(!0)},[]),j=l.useCallback(()=>{a(!1)},[]),L=l.useCallback(()=>{n(!0),Z(s).then(()=>{n(!1),A.success(p("sendSuccess"))}).catch(()=>{n(!1)})},[s,p]);return e.jsx(O,{children:t?d?e.jsx(H,{email:s,loading:i,onBack:j,onSendEmailAgain:L}):e.jsx(K,{onContinue:j}):e.jsx(W,{onRegisterSuccess:m})})}export{le as RegisterPage};
